<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="manifest" href="/manifest.json">
    <meta property="og:site_name" content="Poke!">
    <meta property="og:title" content="Poke!" />
    <meta property="og:description" content="Poke your friends and family, straight from the browser!" />
    <meta property="og:image:secure_url" itemprop="image" content="https://cdn.glitch.global/9cf5e7ce-73a2-465d-9c86-f14880243c04/icon.png?v=1668932705427">
    <meta property="og:type" content="website" />
    <link rel="icon" href="https://cdn.glitch.global/9cf5e7ce-73a2-465d-9c86-f14880243c04/icon.png?v=1668932705427" />
    <title>Poke!</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.4/css/bulma.min.css" integrity="sha512-HqxHUkJM0SYcbvxUw5P60SzdOTy/QVwA1JJrvaXJv4q7lmbDZCmZaqz01UPOaQveoxfYRv1tHozWGPMcuTBuvQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script>
    // This is just to force HTTPS (can't do it statically on glitch)
    if(location.protocol == 'http:') location.protocol = 'https:';
    if('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js')
        .then(reg => console.log('Service Worker registered', reg))
        .catch(err => console.error('Service Worker **not** registered', err));
    }
    else {
      console.warn('Service Worker not supported in this browser');
    }    
  </script>
    <script src="index.js"></script>
  </head>
  <body class="has-background-dark">
    <section class="section main">
        <div class="container">
          <div class="columns is-multiline">
          <div class="column is-12">
            <h1 class="title is-1 has-text-white">Push notifications client</h1>
            <noscript>
              You have JavaScript disabled. This app requires JavaScript to work.
            </noscript>
          </div>
          <div class="column is-6">
            <div class="card">
              <header class="card-header has-background-info">
                <p class="card-header-title  has-text-white">
                  Subscription
                </p>
              </header>
              <div class="card-content">
                <div class="content">
                  <label class="label">Status</label>
                  <textarea
              class="textarea"
              readonly
              id="subscription-status-message">No push subscription is active.</textarea>
                </div>
              </div>
              <footer class="card-footer">
                <button
                  class="button card-footer-item"
                  id="subscribe"
                  onclick="subscribeToPush()"
                  disabled>
                  Subscribe to push
                </button>
                <button
                  class="button card-footer-item"
                  id="unsubscribe"
                  onclick="unsubscribeFromPush()"
                  disabled>
                  Unsubscribe from push
                </button>
              </footer>
            </div>            
          </div>
          <div class="column is-6">
            <div class="card">
              <header class="card-header has-background-info">
                <p class="card-header-title has-text-white">
                  Service worker
                </p>
              </header>
              <div class="card-content">
                <div class="content">
                  <label class="label">Status</label>
                  <textarea
                  class="textarea"
                  readonly 
                  id="registration-status-message">This browser doesn't support service workers.</textarea>
                </div>
              </div>
              <footer class="card-footer">
                <button
                  class="button card-footer-item"
                  id="register"
                  onclick="registerServiceWorker()"
                  disabled>
                  Register service worker
                </button>
                <button
                  class="button card-footer-item"
                  id="unregister"
                  onclick="unregisterServiceWorker()"
                  disabled>
                  Unregister service worker
                </button>
              </footer>
            </div>            
          </div>
          <div class="column is-12">
            <div class="card">
              <header class="card-header has-background-info">
                <p class="card-header-title has-text-white">
                  Notifications
                </p>
              </header>
              <div class="card-content">
                <div class="content">
                  <label class="label">Status</label>
                  <textarea
                  class="textarea"
                  readonly 
              id="notification-status-message">No notifications sent yet.</textarea>
                  <div class="field">
                    <label class="label" for="userName">Username</label>
                    <div class="control">
                      <input class="input" type="text" name="userName" id="userName" placeholder="Write username here">
                    </div>
                  </div>
                  <div class="field">
                    <label class="label" for="notification-subject">Subject</label>
                    <div class="control">
                      <input class="input" type="text" name="notification-subject" id="notification-subject" placeholder="Write subject here">
                    </div>
                  </div>
                  <div class="field">
                    <label class="label" for="notification-message">Message</label>
                    <div class="control">
                      <textarea class="textarea" id="notification-message" name="notification-message" placeholder="Write message here"></textarea>
                    </div>
                  </div>
                </div>
              </div>
              <footer class="card-footer">
                <button
                  class="button card-footer-item"
                  id="notify-me"
                  onclick="notifyMe()"
                  disabled>
                  Notify me
                </button>
                <button
                  class="button card-footer-item"
                  id="notify-all"
                  onclick="notifyAll()">
                  Notify all
                </button>
              </footer>
            </div>            
          </div>
        </div>
      </div>
    </section>
  </body>
</html>